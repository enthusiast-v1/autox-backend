generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum ERole {
  CUSTOMER
  DRIVER
  ADMIN
  SUPER_ADMIN
}

enum EGender {
  Male
  Female
  Others
}

enum EDriverStatus {
  Available
  In_A_Trip
  Accident
  On_Vacation
}

enum ERentType {
  Hourly
  Daily
  Weekly
  Monthly
  Yearly
}

enum EFuelType {
  LPG
  CNG
  Petrol
  Diesel
  Gasoline
  Kerosene
}

enum EVehicleType {
  S
  M
  L
  XL
  XXL
  XXXL
}

enum EVehicleStatus {
  Available
  In_A_Trip
  Accident
  Maintenance
}

model User {
  id String @id @default(uuid())

  email    String @unique
  password String
  role     ERole  @default(CUSTOMER)

  profile  Profile?
  driver   Driver?
  bookings Booking[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("users")
}

model Driver {
  id String @id @default(uuid())

  licenseNo     String
  licenseExpire DateTime
  nidNo         String
  status        EDriverStatus @default(Available)

  userId String @unique
  user   User   @relation(fields: [userId], references: [id])

  vehicle Vehicle?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("drivers")
}

model Profile {
  id String @id @default(uuid())

  firstName    String
  lastName     String
  gender       EGender
  dateOfBirth  DateTime?
  address      String?
  image        String?
  contactNo    String
  emergContact String?

  userId String @unique
  user   User   @relation(fields: [userId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("profiles")
}

model VehicleBrand {
  id String @id @default(uuid())

  brand String

  vehicles Vehicle[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("vehicle_brands")
}

model Vehicle {
  id String @id @default(uuid())

  mileage           Float
  color             String
  images            String[]
  overview          String         @db.VarChar()
  basePrice         Int
  fuelType          EFuelType
  passengerCapacity Int
  location          String
  plateNo           String
  chassisNo         String
  status            EVehicleStatus @default(Available)
  owner             String?
  vehicleType       EVehicleType

  driverId String @unique
  driver   Driver @relation(fields: [driverId], references: [id])

  brandId String
  brand   VehicleBrand @relation(fields: [brandId], references: [id])

  bookings Booking[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("vehicles")
}

model RentType {
  id String @id @default(uuid())

  type    ERentType
  booking Booking?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("rent_types")
}

model Booking {
  id String @id @default(uuid())

  pickUpDate      DateTime
  dropOffDate     DateTime
  pickUpTime      DateTime
  dropOffTime     DateTime
  pickUpLocation  String
  dropOffLocation String

  userId String
  user   User   @relation(fields: [userId], references: [id])

  vehicleId String
  vehicle   Vehicle @relation(fields: [vehicleId], references: [id])

  promoId String?

  rentTypeId String   @unique
  rentType   RentType @relation(fields: [rentTypeId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("bookings")
}
